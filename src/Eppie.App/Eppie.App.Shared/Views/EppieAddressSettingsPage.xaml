<local:EppieAddressSettingsPageBase x:Class="Tuvi.App.Shared.Views.EppieAddressSettingsPage"
                                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                                    xmlns:behaviors="using:Eppie.App.UI.Behaviors"
                                    xmlns:controls="using:Tuvi.App.Shared.Controls"
                                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                                    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
                                    xmlns:local="using:Tuvi.App.Shared.Views"
                                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                                    xmlns:viewmodels="using:Tuvi.App.ViewModels"
                                    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                                    mc:Ignorable="d">

    <local:EppieAddressSettingsPageBase.Resources>
        <x:Double x:Key="TextBoxWidth">276</x:Double>

        <x:Double x:Key="HugeOptionGapHeight">60</x:Double>
        <x:Double x:Key="NormalOptionGapHeight">36</x:Double>

        <x:String x:Key="AliasPlaceholderText">name.test@eppie</x:String>

    </local:EppieAddressSettingsPageBase.Resources>

    <local:EppieAddressSettingsPageBase.DataContext>
        <viewmodels:EppieAddressSettingsPageViewModel />
    </local:EppieAddressSettingsPageBase.DataContext>

    <interactivity:Interaction.Behaviors>
        <behaviors:DialogBehavior ApplyCommand="{x:Bind ViewModel.ApplySettingsCommand}"
                                  CancelCommand="{x:Bind ViewModel.CancelSettingsCommand}"
                                  HandleErrorCommand="{x:Bind ViewModel.HandleErrorCommand}" />
    </interactivity:Interaction.Behaviors>

    <controls:AddressSettingsView x:Uid="AddressSettingsView"
                                  ApplyCommand="{x:Bind ViewModel.ApplySettingsCommand}"
                                  CancelCommand="{x:Bind ViewModel.CancelSettingsCommand}"
                                  IsApplying="{x:Bind ViewModel.IsWaitingResponse, Mode=OneWay}"
                                  IsRemoveButtonVisible="{x:Bind ViewModel.IsCreatingAccountMode, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}"
                                  RemoveCommand="{x:Bind ViewModel.RemoveAccountCommand}">
        <StackPanel>

            <controls:AddressControl x:Uid="AddressControl"
                                     Address="{x:Bind ViewModel.AddressSettingsModel.Email.Value, Mode=OneWay}"
                                     HideWarning="False" />

            <controls:OptionControl x:Uid="EppieAliasOption"
                                    GapHeight="{StaticResource HugeOptionGapHeight}"
                                    Visibility="{x:Bind ViewModel.AddressSettingsModel.IsSenderNameVisible}">
                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                    <controls:ErrorControl HorizontalAlignment="Left"
                                           VerticalAlignment="Top"
                                           Property="{x:Bind ViewModel.AddressSettingsModel.SenderName, Mode=OneWay}">
                        <controls:ErrorControl.InnerContent>
                            <TextBox Width="{StaticResource TextBoxWidth}"
                                     HorizontalAlignment="Left"
                                     VerticalAlignment="Top"
                                     IsEnabled="{x:Bind ViewModel.IsClaimingName, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}"
                                     IsSpellCheckEnabled="False"
                                     PlaceholderText="{StaticResource AliasPlaceholderText}"
                                     Text="{x:Bind ViewModel.AddressSettingsModel.SenderName.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </controls:ErrorControl.InnerContent>
                    </controls:ErrorControl>
                    <Button x:Uid="VerifyButton"
                            MinWidth="64"
                            Margin="4,0,0,0"
                            Command="{x:Bind ViewModel.ClaimNameCommand}"
                            IsEnabled="{x:Bind ViewModel.IsClaimingName, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}" />
                    <ProgressRing x:Name="ClaimingProgressRing"
                                  Width="20"
                                  Height="20"
                                  Margin="8,0,0,0"
                                  x:Load="{x:Bind ViewModel.IsClaimingName, Mode=OneWay}"
                                  IsActive="True" />
                </StackPanel>
            </controls:OptionControl>

            <controls:OptionControl x:Uid="SynchronizationIntervalOption"
                                    GapHeight="{StaticResource NormalOptionGapHeight}"
                                    HideNote="True">
                <StackPanel Orientation="Horizontal">
                    <controls:ErrorControl HorizontalAlignment="Stretch"
                                           VerticalAlignment="Center"
                                           Property="{x:Bind ViewModel.AddressSettingsModel.SynchronizationInterval, Mode=OneWay}">
                        <controls:ErrorControl.InnerContent>
                            <TextBox IsSpellCheckEnabled="False" Text="{x:Bind ViewModel.AddressSettingsModel.SynchronizationInterval.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </controls:ErrorControl.InnerContent>
                    </controls:ErrorControl>
                    <TextBlock x:Uid="SynchronizationIntervalUnits"
                               Margin="12,0"
                               VerticalAlignment="Center" />
                </StackPanel>
            </controls:OptionControl>

        </StackPanel>
    </controls:AddressSettingsView>

</local:EppieAddressSettingsPageBase>
